<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–°—Ç–µ–ø–∞: –î–æ–ª–≥–æ–≤–∞—è –ü–∏–∑–¥–µ—Ü</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            -webkit-tap-highlight-color: transparent;
            -webkit-user-select: none;
            user-select: none;
        }
        
        body {
            background: linear-gradient(135deg, #2d0000 0%, #5c0000 100%);
            color: white;
            min-height: 100vh;
            padding: 10px;
            overflow-x: hidden;
            touch-action: manipulation;
        }
        
        .container {
            max-width: 100%;
            margin: 0 auto;
        }
        
        .header {
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 15px;
            border: 2px solid #ff0000;
            box-shadow: 0 0 20px rgba(255, 0, 0, 0.3);
        }
        
        h1 {
            font-size: 1.4rem;
            text-align: center;
            color: #ff4444;
            text-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
            margin-bottom: 10px;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin-bottom: 10px;
        }
        
        .stat-item {
            background: rgba(255, 0, 0, 0.2);
            padding: 8px;
            border-radius: 8px;
            text-align: center;
            font-size: 0.9rem;
        }
        
        .stat-value {
            font-weight: bold;
            font-size: 1.1rem;
            color: #ff6b6b;
        }
        
        .progress-container {
            margin-top: 10px;
        }
        
        .progress-bar {
            height: 10px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            overflow: hidden;
            margin-top: 5px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff0000, #ff6b6b);
            transition: width 0.5s ease;
        }
        
        .character-container {
            text-align: center;
            margin: 15px 0;
            font-size: 4rem;
            transition: all 0.3s ease;
        }
        
        .actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .action-btn {
            padding: 15px 10px;
            border: none;
            border-radius: 12px;
            background: linear-gradient(135deg, rgba(255, 0, 0, 0.3), rgba(139, 0, 0, 0.3));
            color: white;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 80px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 5px;
            border: 1px solid rgba(255, 0, 0, 0.5);
        }
        
        .action-btn:active {
            transform: scale(0.95);
            background: linear-gradient(135deg, rgba(255, 0, 0, 0.5), rgba(139, 0, 0, 0.5));
        }
        
        .action-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .events {
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 15px;
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #ff0000;
        }
        
        .event {
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 8px;
            background: rgba(255, 0, 0, 0.1);
            border-left: 4px solid #ff0000;
            animation: slideIn 0.3s ease;
        }
        
        .event.danger {
            background: rgba(255, 0, 0, 0.3);
            border-left-color: #ff4444;
        }
        
        .event.success {
            background: rgba(0, 255, 0, 0.1);
            border-left-color: #00ff00;
        }
        
        .event.warning {
            background: rgba(255, 165, 0, 0.2);
            border-left-color: #ffa500;
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 20px;
        }
        
        .modal-content {
            background: linear-gradient(135deg, #5c0000, #2d0000);
            padding: 20px;
            border-radius: 15px;
            max-width: 500px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            border: 2px solid #ff0000;
        }
        
        .modal-close {
            background: #ff0000;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 15px;
            width: 100%;
        }
        
        .option {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 4px solid #ff0000;
        }
        
        .option:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .game-over {
            text-align: center;
            padding: 30px;
        }
        
        .game-over h2 {
            color: #ff0000;
            font-size: 2rem;
            margin-bottom: 20px;
            text-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
        
        .shake {
            animation: shake 0.5s ease-in-out;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (min-width: 768px) {
            .container {
                max-width: 500px;
            }
            
            .actions {
                grid-template-columns: repeat(3, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üê∑ –°–¢–ï–ü–ê: –î–û–õ–ì–û–í–ê–Ø –ü–ò–ó–î–ï–¶</h1>
            <div class="stats">
                <div class="stat-item">
                    –î–µ–Ω—å: <div class="stat-value" id="day">1</div>
                </div>
                <div class="stat-item">
                    –î–µ–Ω—å–≥–∏: <div class="stat-value" id="money">5 000 ‚ÇΩ</div>
                </div>
                <div class="stat-item">
                    –î–æ–ª–≥: <div class="stat-value" id="debt">100 000 ‚ÇΩ</div>
                </div>
                <div class="stat-item">
                    –ó–¥–æ—Ä–æ–≤—å–µ: <div class="stat-value" id="health">100</div>
                </div>
            </div>
            <div class="progress-container">
                –°—Ç—Ä–µ—Å—Å: <span id="stress">0</span>/100
                <div class="progress-bar">
                    <div class="progress-fill" id="stress-bar" style="width: 0%"></div>
                </div>
            </div>
        </div>
        
        <div class="character-container">
            <span id="stepa-emoji">üò¥</span>
            <div id="phone-indicator" style="display: none; font-size: 1.5rem; margin-top: 10px;">üìû</div>
        </div>
        
        <div class="actions">
            <button class="action-btn" onclick="work()">
                <span>üíº</span>
                <span>–í–∫–∞–ª—ã–≤–∞—Ç—å</span>
            </button>
            <button class="action-btn" onclick="showFriendsModal()">
                <span>üë•</span>
                <span>–ó–∞–Ω–∏–º–∞—Ç—å</span>
            </button>
            <button class="action-btn" onclick="findJob()">
                <span>üîç</span>
                <span>–ò—Å–∫–∞—Ç—å —Ä–∞–±–æ—Ç—É</span>
            </button>
            <button class="action-btn" onclick="showBusinessModal()">
                <span>üí∏</span>
                <span>–ë–∏–∑–Ω–µ—Å</span>
            </button>
            <button class="action-btn" onclick="relieveStress()">
                <span>üçª</span>
                <span>–°–Ω—è—Ç—å —Å—Ç—Ä–µ—Å—Å</span>
            </button>
            <button class="action-btn" onclick="showCriminalModal()">
                <span>üî´</span>
                <span>–ö—Ä–∏–º–∏–Ω–∞–ª</span>
            </button>
            <button class="action-btn" onclick="payDebt()">
                <span>üí∞</span>
                <span>–û—Ç–¥–∞—Ç—å –¥–æ–ª–≥</span>
            </button>
            <button class="action-btn" onclick="takeLoan()">
                <span>üè¶</span>
                <span>–í–∑—è—Ç—å –∫—Ä–µ–¥–∏—Ç</span>
            </button>
            <button class="action-btn" onclick="escape()">
                <span>üèÉ</span>
                <span>–°–≤–∞–ª–∏—Ç—å</span>
            </button>
        </div>
        
        <div class="events" id="events">
            <div class="event danger">
                üìû –î–µ–Ω—å 1: –ü—Ä–æ—Å–Ω—É–ª—Å—è —Å –±–æ–¥—É–Ω–∞. –ë—Ä–∞—Ç–æ–∫ –°–µ—Ä—ë–≥–∞ –∑–≤–æ–Ω–∏—Ç: "–°—Ç–µ–ø–∞, –≥–¥–µ –º–æ–∏ 100–∫, –º—É–¥–∏–ª–∞? –í–µ—Ä–Ω–∏ –¥–æ –∫–æ–Ω—Ü–∞ –º–µ—Å—è—Ü–∞ –∏–ª–∏ —É–±—å—é!"
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <div id="friends-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <h3>üë• –ó–∞–Ω–∏–º–∞—Ç—å –±–∞–±–∫–∏ —É –¥—Ä—É–∑–µ–π</h3>
            <div id="friends-options">
                <!-- –û–ø—Ü–∏–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —á–µ—Ä–µ–∑ JS -->
            </div>
            <button class="modal-close" onclick="hideModal('friends-modal')">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <div id="game-over-modal" class="modal" style="display: none;">
        <div class="modal-content game-over">
            <h2 id="game-over-title">–ò–ì–†–ê –û–ö–û–ù–ß–ï–ù–ê</h2>
            <p id="game-over-text"></p>
            <button class="modal-close" onclick="restartGame()">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        let tg = window.Telegram.WebApp;
        tg.expand();
        
        // –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let gameState = {
            day: 1,
            totalDays: 365,
            money: 5000,
            debt: 100000,
            health: 100,
            stress: 0,
            isAlive: true,
            gameOver: false,
            beaten: false,
            phoneRinging: false,
            reputation: 0,
            
            // –î—Ä—É–∑—å—è –∏ –∫—Ä–µ–¥–∏—Ç–æ—Ä—ã
            friends: [
                {name: "–í–∞—Å—å–∫–∞", description: "–°—Ç–∞—Ä—ã–π –¥—Ä—É–≥, –Ω–æ —Å–µ–π—á–∞—Å —Å–∞–º –≤ –∂–æ–ø–µ", maxLoan: 5000, borrowed: false, chance: 0.6},
                {name: "–ü–µ—Ç—Ä–æ", description: "–ñ–∞–¥–Ω–∞—è —Å–≤–æ–ª–æ—á—å, —Å—á–∏—Ç–∞–µ—Ç –∫–∞–∂–¥—É—é –∫–æ–ø–µ–π–∫—É", maxLoan: 3000, borrowed: false, chance: 0.3},
                {name: "–°–µ–º—ë–Ω", description: "–î–æ–±—Ä—è–∫, –Ω–æ –µ–≥–æ –±–∞–±–∞ –Ω–µ –¥–∞–µ—Ç –Ω–∏ –∫–æ–ø–µ–π–∫–∏", maxLoan: 7000, borrowed: false, chance: 0.7},
                {name: "–ì—Ä–∏—à–∞", description: "–ë—Ä–∞—Ç–æ–∫, –¥–∞—Å—Ç –≤ –¥–æ–ª–≥, –Ω–æ –ø–æ–¥ –ø—Ä–æ—Ü–µ–Ω—Ç—ã", maxLoan: 10000, borrowed: false, chance: 0.8}
            ],
            
            creditors: [
                {name: "–ë—Ä–∞—Ç–æ–∫ –°–µ—Ä—ë–≥–∞", amount: 50000, daysLeft: 30, aggressiveness: 0.9},
                {name: "–ë–∞–Ω–∫ '–•—É–µ–≤—ã–π'", amount: 30000, daysLeft: 45, aggressiveness: 0.6},
                {name: "–ú–§–û '–õ–æ—Ö–æ—Ç—Ä–æ–Ω'", amount: 20000, daysLeft: 15, aggressiveness: 0.8}
            ],
            
            events: []
        };

        // –£–≥–∞—Ä–Ω—ã–µ —Ñ—Ä–∞–∑—ã –¥–ª—è —Å–æ–±—ã—Ç–∏–π
        const phrases = {
            work: [
                "üíº –ü–æ—Ä–∞–±–æ—Ç–∞–ª –∫–∞–∫ –ª–æ—Ö –≤ –≥–æ–≤–Ω–µ. –ó–∞—Ä–∞–±–æ—Ç–∞–ª: {money} ‚ÇΩ",
                "üîß –í–∫–∞–ª—ã–≤–∞–ª –∫–∞–∫ –ø–∞–¥–ª–∞ –Ω–∞ —Å—Ç—Ä–æ–π–∫–µ. –ü–æ–ª—É—á–∏–ª: {money} ‚ÇΩ",
                "üõ†Ô∏è –•—É—è—Ä–∏–ª –∫–∞–∫ –∫–æ–Ω—å –∑–∞ –∫–æ–ø–µ–π–∫–∏. –ù–∞–±—Ä–∞–ª: {money} ‚ÇΩ"
            ],
            
            stress: [
                "üçª –ù–∞–∂—Ä–∞–ª—Å—è –≤ –∑—é–∑—é. –°—Ç—Ä–µ—Å—Å -{stress}, –∑–¥–æ—Ä–æ–≤—å–µ -{health}",
                "ü•É –ó–∞–ø–∏–ª–∏–ª –∫–æ–Ω—å—è–∫–∞. –ß—É–≤—Å—Ç–≤—É–µ—à—å —Å–µ–±—è –±–æ–¥—Ä–µ–µ",
                "üíä –ü—Ä–∏–Ω—è–ª —Ç–∞–±–ª–µ—Ç–æ–∫ –æ—Ç –¥–µ–ø—Ä–µ—Å—Å–∏–∏. –í—Ä–æ–¥–µ –ø–æ–ª–µ–≥—á–∞–ª–æ"
            ],
            
            debt: [
                "üí∞ –û—Ç–¥–∞–ª –¥–æ–ª–≥ {debt} ‚ÇΩ. –°–µ—Ä—ë–≥–∞ –ø–æ–∫–∞ –Ω–µ –±—å–µ—Ç",
                "üí∏ –í—ã–ø–ª–∞—Ç–∏–ª —á–∞—Å—Ç—å –¥–æ–ª–≥–∞. –ï—â—ë {debt} ‚ÇΩ –æ—Å—Ç–∞–ª–æ—Å—å, –±–ª—è–¥—å",
                "üè¶ –ü–æ–≥–∞—Å–∏–ª {debt} ‚ÇΩ. –ö—Ä–µ–¥–∏—Ç–æ—Ä—ã –Ω–µ–º–Ω–æ–≥–æ —É—Å–ø–æ–∫–æ–∏–ª–∏—Å—å"
            ],
            
            threats: [
                "üìû –°–µ—Ä—ë–≥–∞ –∑–≤–æ–Ω–∏—Ç: '–ì–¥–µ –±–∞–±–∫–∏, –º—É–¥–∏–ª–∞? –Ø —Ç–µ–±—è –Ω–∞–π–¥—É –∏ –≤—ã–µ–±—É!'",
                "üíÄ –ü–æ–ª—É—á–∏–ª –°–ú–°: '–°—Ç–µ–ø–∞, –∑–∞–≤—Ç—Ä–∞ –±—É–¥—É. –ì–æ—Ç–æ–≤—å –±–∞–±–∫–∏ –∏–ª–∏ –≥–æ—Ç–æ–≤—å –∂–æ–ø—É'",
                "üëÆ –ö–æ–ª–ª–µ–∫—Ç–æ—Ä—ã –ø–æ–¥–æ–∂–≥–ª–∏ –¥–≤–µ—Ä—å. –ü—Ä–∏—à–ª–æ—Å—å –æ—Ç–¥–∞—Ç—å 5000 ‚ÇΩ"
            ],
            
            insults: [
                "–¢—ã –∫–æ–Ω—á–µ–Ω—ã–π –¥–æ–ª–±–æ—ë–±!",
                "–ò–¥–∏ —Ä–∞–±–æ—Ç–∞–π, –ª–µ–Ω—Ç—è–π –µ–±–∞–Ω—ã–π!",
                "–£ —Ç–µ–±—è —Ä—É–∫–∏ –∏–∑ –∂–æ–ø—ã —Ä–∞—Å—Ç—É—Ç!",
                "–¢–≤–æ—è –∂–∏–∑–Ω—å - –ø–∏–∑–¥–µ—Ü!",
                "–¢—ã —Ä–æ–∂–¥–µ–Ω –¥–ª—è —Å—Ç—Ä–∞–¥–∞–Ω–∏–π, —É—ë–±–æ–∫!"
            ]
        };

        // –§—É–Ω–∫—Ü–∏–∏ –∏–≥—Ä—ã
        function addEvent(message, type = "default") {
            const eventsDiv = document.getElementById('events');
            const eventElement = document.createElement('div');
            eventElement.className = `event ${type}`;
            eventElement.textContent = message;
            eventsDiv.prepend(eventElement);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ–±—ã—Ç–∏–µ
            gameState.events.push({day: gameState.day, message, type});
            
            // –ê–≤—Ç–æ—Å–∫—Ä–æ–ª–ª
            eventsDiv.scrollTop = 0;
        }

        function updateUI() {
            document.getElementById('day').textContent = gameState.day;
            document.getElementById('money').textContent = gameState.money.toLocaleString('ru-RU') + ' ‚ÇΩ';
            document.getElementById('debt').textContent = gameState.debt.toLocaleString('ru-RU') + ' ‚ÇΩ';
            document.getElementById('health').textContent = gameState.health;
            document.getElementById('stress').textContent = gameState.stress;
            document.getElementById('stress-bar').style.width = `${gameState.stress}%`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —ç–º–æ—Ü–∏—é –°—Ç–µ–ø—ã
            const stepaEmoji = document.getElementById('stepa-emoji');
            const phoneIndicator = document.getElementById('phone-indicator');
            
            if (gameState.health <= 30) {
                stepaEmoji.textContent = "üíÄ";
            } else if (gameState.stress >= 70) {
                stepaEmoji.textContent = "üò°";
            } else if (gameState.money < 1000) {
                stepaEmoji.textContent = "üò≠";
            } else {
                stepaEmoji.textContent = "üò¥";
            }
            
            if (gameState.phoneRinging) {
                phoneIndicator.style.display = 'block';
            } else {
                phoneIndicator.style.display = 'none';
            }
        }

        function work() {
            if (gameState.gameOver) return;
            
            const earnings = Math.floor(Math.random() * 2000) + 500;
            gameState.money += earnings;
            gameState.health -= 5;
            gameState.stress += 10;
            
            const phrase = phrases.work[Math.floor(Math.random() * phrases.work.length)]
                .replace('{money}', earnings);
            
            addEvent(phrase);
            nextDay();
        }

        function showFriendsModal() {
            const optionsDiv = document.getElementById('friends-options');
            optionsDiv.innerHTML = '';
            
            gameState.friends.forEach(friend => {
                if (!friend.borrowed) {
                    const option = document.createElement('div');
                    option.className = 'option';
                    option.innerHTML = `
                        <strong>${friend.name}</strong><br>
                        <small>${friend.description}</small><br>
                        <em>–ú–æ–∂–µ—Ç –¥–∞—Ç—å: ${friend.maxLoan} ‚ÇΩ</em>
                    `;
                    option.onclick = () => borrowFromFriend(friend);
                    optionsDiv.appendChild(option);
                }
            });
            
            showModal('friends-modal');
        }

        function borrowFromFriend(friend) {
            if (Math.random() <= friend.chance) {
                gameState.money += friend.maxLoan;
                friend.borrowed = true;
                
                const responses = [
                    `‚úÖ ${friend.name} –¥–∞–ª –≤ –¥–æ–ª–≥ ${friend.maxLoan} ‚ÇΩ. "–í–µ—Ä–Ω–∏ –≤–æ–≤—Ä–µ–º—è, –∞ —Ç–æ –µ–±–∞–ª—å–Ω–∏–∫ –Ω–∞–±—å—é!"`,
                    `üëç ${friend.name} –æ–¥–æ–ª–∂–∏–ª ${friend.maxLoan} ‚ÇΩ. "–¢–æ–ª—å–∫–æ –Ω–µ –ø—Ä–æ–¥—É–π –≤—Å—ë –≤ –∫–∞–∑–∏–Ω–æ, –º—É–¥–∏–ª–∞!"`,
                    `üíµ ${friend.name} –ø—Ä–æ—Ç—è–Ω—É–ª ${friend.maxLoan} ‚ÇΩ. "–ü–æ–º–Ω–∏, –¥–æ–ª–≥ –ø–ª–∞—Ç–µ–∂–æ–º –∫—Ä–∞—Å–µ–Ω, –µ–ø—Ç–∞!"`
                ];
                
                addEvent(responses[Math.floor(Math.random() * responses.length)], "success");
            } else {
                const rejections = [
                    `‚ùå ${friend.name} –ø–æ—Å–ª–∞–ª —Ç–µ–±—è: "–°–∞–º –≤ –¥–æ–ª–≥–∞—Ö, –ø–æ—à—ë–ª –Ω–∞ —Ö—É–π!"`,
                    `üö´ ${friend.name}: "–ò–¥–∏ —Ä–∞–±–æ—Ç–∞–π, —Ö–∞–ª—è–≤—â–∏–∫ –µ–±–∞–Ω—ã–π!"`,
                    `üí© ${friend.name} —Å–∫–∞–∑–∞–ª: "–î–µ–Ω–µ–≥ –Ω–µ—Ç, –Ω–æ —Ç—ã –¥–µ—Ä–∂–∏—Å—å, –ª–æ—Ö!"`
                ];
                
                addEvent(rejections[Math.floor(Math.random() * rejections.length)], "danger");
                gameState.stress += 15;
            }
            
            hideModal('friends-modal');
            nextDay();
        }

        function findJob() {
            if (Math.random() > 0.7) {
                addEvent("üéâ –ù–∞—à—ë–ª –Ω–æ—Ä–º–∞–ª—å–Ω—É—é —Ä–∞–±–æ—Ç—É! –ó–∞—Ä–ø–ª–∞—Ç–∞ —É–≤–µ–ª–∏—á–∏–ª–∞—Å—å", "success");
                // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –¥–æ—Ö–æ–¥ –æ—Ç —Ä–∞–±–æ—Ç—ã
            } else {
                addEvent("üòû –ù–∏–∫—Ç–æ –Ω–µ –±–µ—Ä–µ—Ç –Ω–∞ —Ä–∞–±–æ—Ç—É. '–¢—ã –∫—Ç–æ —Ç–∞–∫–æ–π, –±–ª—è–¥—å?'", "danger");
                gameState.stress += 10;
            }
            nextDay();
        }

        function showBusinessModal() {
            const businesses = [
                {name: "–®–∞—É—Ä–º–∏—á–Ω–∞—è", cost: 50000, income: 5000, risk: 0.3},
                {name: "–¢–∞–∫—Å–∏—Å—Ç", cost: 20000, income: 2000, risk: 0.5},
                {name: "–ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã", cost: 10000, income: 10000, risk: 0.8}
            ];
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª–∫—É —Å –±–∏–∑–Ω–µ—Å–æ–º
            addEvent("üí∏ –ë–∏–∑–Ω–µ—Å - —ç—Ç–æ —Ä–∏—Å–∫. –ú–æ–∂–Ω–æ –ø—Ä–æ–≥–æ—Ä–µ—Ç—å –∫–∞–∫ –ª–æ—Ö", "warning");
            nextDay();
        }

        function relieveStress() {
            const cost = 1000;
            if (gameState.money >= cost) {
                gameState.money -= cost;
                const stressRelief = Math.floor(Math.random() * 30) + 10;
                const healthLoss = Math.floor(Math.random() * 10) + 5;
                
                gameState.stress = Math.max(0, gameState.stress - stressRelief);
                gameState.health -= healthLoss;
                
                const phrase = phrases.stress[Math.floor(Math.random() * phrases.stress.length)]
                    .replace('{stress}', stressRelief)
                    .replace('{health}', healthLoss);
                
                addEvent(phrase, "success");
            } else {
                addEvent("üí∏ –ù–µ—Ç –¥–µ–Ω–µ–≥ –Ω–∞ –≤—ã–ø–∏–≤–∫—É! –ò–¥–∏ —Ä–∞–±–æ—Ç–∞–π, –Ω–∏—â–µ–±—Ä–æ–¥!", "danger");
            }
            nextDay();
        }

        function showCriminalModal() {
            const crimes = [
                {name: "–û–≥—Ä–∞–±–∏—Ç—å –±–∞–±–∫—É", reward: 2000, risk: 0.6, penalty: "–ë–∞–±–∫–∞ –æ–∫–∞–∑–∞–ª–∞—Å—å —á–µ—Ä–Ω—ã–º –ø–æ—è—Å–æ–º –ø–æ –∫–∞—Ä–∞—Ç–µ"},
                {name: "–í–∑–ª–æ–º–∞—Ç—å –±–∞–Ω–∫–æ–º–∞—Ç", reward: 10000, risk: 0.8, penalty: "–ú–µ–Ω—Ç—ã –ø–æ–π–º–∞–ª–∏ —Å –ø–æ–ª–∏—á–Ω—ã–º"},
                {name: "–£–≥–æ–Ω –º–∞—à–∏–Ω—ã", reward: 15000, risk: 0.7, penalty: "–•–æ–∑—è–∏–Ω –æ–∫–∞–∑–∞–ª—Å—è –±—Ä–∞—Ç–∫–æ–º"}
            ];
            
            addEvent("üî´ –ö—Ä–∏–º–∏–Ω–∞–ª - –±—ã—Å—Ç—Ä—ã–π –ø—É—Ç—å –∏–ª–∏ –±—ã—Å—Ç—Ä–∞—è —Å–º–µ—Ä—Ç—å", "warning");
            nextDay();
        }

        function payDebt() {
            if (gameState.money <= 0) {
                addEvent("üí∏ –ù–µ—Ç –¥–µ–Ω–µ–≥ –¥–ª—è –≤—ã–ø–ª–∞—Ç—ã! –ò–¥–∏ —Ä–∞–±–æ—Ç–∞–π, –ª–µ–Ω—Ç—è–π!", "danger");
                return;
            }
            
            const payment = Math.min(gameState.money, 10000);
            gameState.money -= payment;
            gameState.debt -= payment;
            
            const phrase = phrases.debt[Math.floor(Math.random() * phrases.debt.length)]
                .replace('{debt}', payment)
                .replace('{debt}', gameState.debt);
            
            addEvent(phrase, "success");
            gameState.stress -= 20;
            nextDay();
        }

        function takeLoan() {
            const loan = Math.floor(Math.random() * 20000) + 5000;
            gameState.money += loan;
            gameState.debt += loan * 1.5;
            
            addEvent(`üè¶ –í–∑—è–ª –∫—Ä–µ–¥–∏—Ç ${loan} ‚ÇΩ. –¢–µ–ø–µ—Ä—å –¥–æ–ª–∂–µ–Ω ${gameState.debt.toLocaleString('ru-RU')} ‚ÇΩ, –ª–æ—Ö!`, "warning");
            gameState.stress += 10;
            nextDay();
        }

        function escape() {
            if (gameState.money < 50000) {
                addEvent("üí∏ –ù—É–∂–Ω–æ 50–∫ —á—Ç–æ–±—ã —Å–≤–∞–ª–∏—Ç—å –∏–∑ —ç—Ç–æ–π –¥—ã—Ä—ã! –ö–æ–ø–∞–π –¥–∞–ª—å—à–µ, —É—ë–±–æ–∫!", "danger");
                return;
            }
            
            gameState.money -= 50000;
            addEvent("‚úàÔ∏è –°–≤–∞–ª–∏–ª –∏–∑ –ö—É—Ä—Å–∫–∞! –ù–æ –¥–æ–ª–≥–∏ –æ—Å—Ç–∞–ª–∏—Å—å...", "success");
            gameState.stress -= 30;
            nextDay();
        }

        function nextDay() {
            if (gameState.gameOver) return;
            
            gameState.day++;
            gameState.health = Math.max(0, gameState.health - 1);
            
            // –°–ª—É—á–∞–π–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
            if (Math.random() < 0.3) {
                generateRandomEvent();
            }
            
            // –ö—Ä–µ–¥–∏—Ç–æ—Ä—ã –±–µ—Å–ø–æ–∫–æ—è—Ç
            if (gameState.day % 7 === 0) {
                harassByCreditors();
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å–ª–æ–≤–∏—è –∫–æ–Ω—Ü–∞ –∏–≥—Ä—ã
            checkGameOver();
            updateUI();
        }

        function generateRandomEvent() {
            const events = [
                () => {
                    const foundMoney = Math.floor(Math.random() * 3000) + 500;
                    gameState.money += foundMoney;
                    addEvent(`üçÄ –ù–∞—à—ë–ª –Ω–∞ —É–ª–∏—Ü–µ ${foundMoney} ‚ÇΩ! –ü–æ–≤–µ–∑–ª–æ, –±–ª—è–¥—å!`, "success");
                },
                () => {
                    const lostMoney = Math.floor(Math.random() * 2000) + 500;
                    gameState.money = Math.max(0, gameState.money - lostMoney);
                    addEvent(`üí∏ –û–±–æ–±—Ä–∞–ª–∏ –≤ –ø–æ–¥–≤–æ—Ä–æ—Ç–Ω–µ! –ü–æ—Ç–µ—Ä—è–ª ${lostMoney} ‚ÇΩ. –ñ–∏–∑–Ω—å - –±–æ–ª—å!`, "danger");
                },
                () => {
                    gameState.health -= 20;
                    addEvent("ü§í –ó–∞–±–æ–ª–µ–ª –≥—Ä–∏–ø–ø–æ–º. –ß—É–≤—Å—Ç–≤—É–µ—à—å —Å–µ–±—è –∫–∞–∫ –¥–µ—Ä—å–º–æ!", "warning");
                },
                () => {
                    if (gameState.money > 1000) {
                        const stolen = Math.floor(gameState.money * 0.3);
                        gameState.money -= stolen;
                        addEvent(`üëª –û–±–æ–∫—Ä–∞–ª–∏ –¥–æ–º–∞! –£–∫—Ä–∞–ª–∏ ${stolen} ‚ÇΩ. –ü–∏–¥–∞—Ä–∞—Å—ã!`, "danger");
                    }
                }
            ];
            
            events[Math.floor(Math.random() * events.length)]();
        }

        function harassByCreditors() {
            gameState.phoneRinging = true;
            setTimeout(() => gameState.phoneRinging = false, 3000);
            
            const threat = phrases.threats[Math.floor(Math.random() * phrases.threats.length)];
            addEvent(threat, "danger");
            
            gameState.stress += 20;
            gameState.health -= 5;
            
            // –®–∞–Ω—Å —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π —Ä–∞—Å–ø—Ä–∞–≤—ã
            if (Math.random() < 0.2) {
                setTimeout(() => {
                    const beatings = [
                        "üëä –ë—Ä–∞—Ç–∫–∏ –∏–∑–±–∏–ª–∏ —Ç–µ–±—è. –ü–æ—Ç–µ—Ä—è–ª 5000 ‚ÇΩ –∏ –∑–¥–æ—Ä–æ–≤—å–µ",
                        "üí• –°–µ—Ä—ë–≥–∞ –ª–∏—á–Ω–æ –ø—Ä–∏—à—ë–ª '–ø–æ–≥–æ–≤–æ—Ä–∏—Ç—å'. –ü–æ–ª—É—á–∏–ª –ø–æ –º–æ—Ä–¥–µ",
                        "üî™ –ö–æ–ª–ª–µ–∫—Ç–æ—Ä—ã –ø–æ—Ä–µ–∑–∞–ª–∏ —à–∏–Ω—ã. –ü—Ä–∏—à–ª–æ—Å—å –ø–ª–∞—Ç–∏—Ç—å –∑–∞ —Ä–µ–º–æ–Ω—Ç"
                    ];
                    
                    const beating = beatings[Math.floor(Math.random() * beatings.length)];
                    addEvent(beating, "danger");
                    
                    gameState.money = Math.max(0, gameState.money - 5000);
                    gameState.health -= 15;
                    updateUI();
                }, 1000);
            }
        }

        function checkGameOver() {
            // –°–º–µ—Ä—Ç—å –æ—Ç —Å—Ç—Ä–µ—Å—Å–∞
            if (gameState.stress >= 100) {
                endGame("üíÄ –°–ú–ï–†–¢–¨ –û–¢ –°–¢–†–ï–°–°–ê", "–¢—ã –Ω–µ –≤—ã–¥–µ—Ä–∂–∞–ª –¥–∞–≤–ª–µ–Ω–∏—è –¥–æ–ª–≥–æ–≤ –∏ –∫—Ä–µ–¥–∏—Ç–æ—Ä–æ–≤. –°–µ—Ä–¥—Ü–µ –Ω–µ –≤—ã–¥–µ—Ä–∂–∞–ª–æ. –¢–≤–æ–∏ –¥–æ–ª–≥–∏ –ø–µ—Ä–µ—à–ª–∏ —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞–º.");
                return;
            }
            
            // –°–º–µ—Ä—Ç—å –æ—Ç –±–æ–ª–µ–∑–Ω–µ–π
            if (gameState.health <= 0) {
                endGame("üè• –°–ú–ï–†–¢–¨ –û–¢ –ë–û–õ–ï–ó–ù–ï–ô", "–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π —Å—Ç—Ä–µ—Å—Å –∏ –Ω–µ–¥–æ–µ–¥–∞–Ω–∏–µ —Å–¥–µ–ª–∞–ª–∏ —Å–≤–æ–µ –¥–µ–ª–æ. –¢–≤–æ–π –æ—Ä–≥–∞–Ω–∏–∑–º —Å–¥–∞–ª—Å—è. –ö—É—Ä—Å–∫ –ø–æ–±–µ–¥–∏–ª.");
                return;
            }
            
            // –†–∞—Å–ø—Ä–∞–≤–∞ –∫—Ä–µ–¥–∏—Ç–æ—Ä–æ–≤
            if (gameState.day >= gameState.totalDays && gameState.debt > 0) {
                endGame("üî´ –ö–ê–ó–ù–¨ –û–¢ –ö–†–ï–î–ò–¢–û–†–û–í", "–ë—Ä–∞—Ç–æ–∫ –°–µ—Ä—ë–≥–∞ –Ω–∞—à–µ–ª —Ç–µ–±—è. –†–∞—Å–ø—Ä–∞–≤–∞ –±—ã–ª–∞ –∂–µ—Å—Ç–æ–∫–æ–π. –¢–≤–æ–∏ –æ—Å—Ç–∞–Ω–∫–∏ –≤—ã–±—Ä–æ—Å–∏–ª–∏ –≤ —Ä–µ–∫—É –°–µ–π–º.");
                return;
            }
            
            // –ü–æ–±–µ–¥–∞
            if (gameState.debt <= 0 && gameState.money >= 50000) {
                endGame("üéâ –ü–û–ë–ï–î–ê! –¢–´ –í–´–ñ–ò–õ!", "–¢—ã —Ä–∞—Å–ø–ª–∞—Ç–∏–ª—Å—è —Å–æ –≤—Å–µ–º–∏ –¥–æ–ª–≥–∞–º–∏ –∏ –Ω–∞—á–∞–ª –Ω–æ–≤—É—é –∂–∏–∑–Ω—å! –ü—Ä–∞–≤–¥–∞, –∑–¥–æ—Ä–æ–≤—å–µ —É–∂–µ –Ω–µ —Ç–æ, –Ω–æ —Ç—ã –∂–∏–≤, –±–ª—è–¥—å!");
                return;
            }
            
            // –ü–æ–ª–Ω–∞—è –Ω–∏—â–µ—Ç–∞
            if (gameState.money <= 0 && gameState.friends.every(f => f.borrowed)) {
                endGame("üèöÔ∏è –ü–û–õ–ù–ê–Ø –ù–ò–©–ï–¢–ê", "–£ —Ç–µ–±—è –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å –≤—Å–µ –¥–µ–Ω—å–≥–∏, –≤—Å–µ –¥—Ä—É–∑—å—è –æ—Ç–≤–µ—Ä–Ω—É–ª–∏—Å—å. –¢—ã –æ—Å—Ç–∞–ª—Å—è –Ω–∞ —É–ª–∏—Ü–µ –±–µ–∑ –±—É–¥—É—â–µ–≥–æ.");
                return;
            }
        }

        function endGame(title, message) {
            gameState.gameOver = true;
            document.getElementById('game-over-title').textContent = title;
            document.getElementById('game-over-text').textContent = message;
            showModal('game-over-modal');
        }

        function restartGame() {
            location.reload();
        }

        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }

        function hideModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        document.addEventListener('DOMContentLoaded', function() {
            updateUI();
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
            document.addEventListener('touchstart', function(e) {
                if (e.touches.length > 1) e.preventDefault();
            }, { passive: false });
            
            document.addEventListener('gesturestart', function(e) {
                e.preventDefault();
            });
        });
    </script>
</body>
</html>
